<!-- Dialogs -->
<span *ngIf="isEditOn()">
    <p-dialog *ngIf="pageEdit" header="Edit Page" [modal]="true" [responsive]="true" [width]="450" [(visible)]="displayEditPageDialog">
        <span class="ui-float-label" style="margin: 15px">
            <input id="float-input" type="text" size="30" pInputText [(ngModel)]="pageEdit.title">
            <label for="float-input">Page Title</label>
        </span>
        <p-footer>
            <button type="button" pButton icon="pi pi-check" (click)="updatePage()" label="OK"></button>
            <button type="button" pButton icon="pi pi-times" (click)="displayEditPageDialog=false" label="Cancel" class="ui-button-secondary"></button>
        </p-footer>
    </p-dialog>

    <p-dialog *ngIf="page" [modal]="true" [responsive]="true" [width]="450" [(visible)]="displayAddSubPageDialog">
        <p-header>
            {{ page.title }}: Add Sub-Page
        </p-header>
        <span class="ui-float-label" style="margin: 15px">
            <input id="pageTitle" type="text" size="30" pInputText [(ngModel)]="pageAdd.title">
            <label for="pageTitle">Page Title</label>
        </span>
        <p-footer>
            <button type="button" pButton icon="pi pi-check" (click)="addSubPage()" label="OK"></button>
            <button type="button" pButton icon="pi pi-close" (click)="displayAddSubPageDialog=false" label="Cancel" class="ui-button-secondary"></button>
        </p-footer>

    </p-dialog>
    <p-confirmDialog key="pageDelete" header="Delete Page?" icon="fa fa-question-circle" width="425"></p-confirmDialog>
</span>

<div class="row adminPanel" *ngIf="isEditOn()">
    <div class="col-md-12">
        <div class="btn-group">
            <button type="button" class="btn btn-sm btn-success adminButton dropdown-toggle" data-toggle="dropdown">
                <i class="fas fa-plus"></i> Add Content
            </button>
            <div class="dropdown-menu">
                <a class="dropdown-item" [routerLink]="" (click)="addContent('Text')">Text/HTML</a>
                <a class="dropdown-item" [routerLink]="" (click)="addContent('Tabs')">Tabs</a>
                <a class="dropdown-item" [routerLink]="" (click)="addContent('Calendar')">Calender</a>
                <a class="dropdown-item" [routerLink]="" (click)="addContent('Files')">PDF Viewer</a>
            </div>
        </div>
        <button class="btn btn-sm btn-primary adminButton" (click)="editPage()">
            <i class="fas fa-edit"></i> Edit Page
        </button>
        <button class="btn btn-sm btn-danger adminButton" (click)="deletePage()">
            <i class="fas fa-trash-alt"></i> Delete Page
        </button>
        <button *ngIf="page && !page.parent" class="btn btn-sm btn-success adminButton" (click)="showAddSubPageDialog()">
            <i class="fas fa-plus"></i> Add Sub-Page
        </button>
    </div>
</div>

<div class="content-container" *ngIf="page">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/"><i class="fas fa-home"></i></a></li>
            <li class="breadcrumb-item" *ngIf="!page.parent">{{ page.menuItem.name }}</li>
            <li class="breadcrumb-item" *ngIf="page.parent">{{ page.parent.menuItem.name }}</li>
            <li class="breadcrumb-item" *ngIf="page.parent"><a  routerLink="/pages/{{ page.parent.id }}">{{ page.parent.title }}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ page.title }}</li>
        </ol>
    </nav>
    <div class="row">
        <div class="col-md-3" *ngIf="page.children.length > 0">
            <div class="card" style="width: 100% ;margin-right: 10px">
                <div class="card-header">{{ page.title }}</div>
                <div class="card-body">
                    <ul class="nav flex-column">
                        <li class="nav-item" *ngFor="let child of page.children">
                            <a class="nav-link" routerLink="/pages/{{ child.id }}">{{ child.title }}</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div [ngClass]="{'col-md-9': page.children.length > 0, 'col-md-12': page.children.length == 0}">
            <div class="content" [ngClass]="{'edit': isEditOn()}" *ngFor="let pageContent of page.pageContents">
                <div *ngIf="pageContent.contentType === 'Text'">
                    <app-content-text [pageContentId]="pageContent.id" [textContent]="pageContent.textContent" [pageComponent]="this"></app-content-text>
                </div>
                <div *ngIf="pageContent.contentType === 'Calendar'">
                    <app-content-calendar [pageContentId]='pageContent.id' [calendarContent]="pageContent.calendarContent" [pageComponent]="this"></app-content-calendar>
                </div>
                <div *ngIf="pageContent.contentType === 'Tabs'">
                    <app-content-tabs [pageContentId]='pageContent.id' [tabContent]="pageContent.tabContent" [pageComponent]="this"></app-content-tabs>
                </div>
                <div *ngIf="pageContent.contentType === 'Files'">
                    <app-content-files [pageContentId]='pageContent.id' [fileContent]="pageContent.fileContent" [pageComponent]="this"></app-content-files>
                </div>
            </div>
        </div>
    </div>
</div>
